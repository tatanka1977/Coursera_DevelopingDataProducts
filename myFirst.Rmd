---
title: "Data_Products"
author: "Benedetto Lo Cicero"
date: "16 Juli 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Basic economic datas

In this html document I want to show some economic facts of 2016 obtained from the economic freedom institute (https://www.fraserinstitute.org/).
First of all I load the dataset and I will clean it

```{r message=FALSE, warning=TRUE}
df <- read.csv2("./2018_EconomicFreedom.csv")
df <- df[,1:9]
df <- df[df$Year==2016,]
library(stringr)
library(janitor)
colnames(df) <- str_remove_all(colnames(df),'X[:digit:][:punct:]{2}')
colnames(df) <- str_replace_all(colnames(df),'[:punct:]'," ")
colnames(df) <- str_replace_all(colnames(df),'   ',' and ')
df <- remove_empty(df, which = c("rows", "cols"))
```

than to center the marker I will use the capital cities with a dataset found on (https://simplemaps.com/data/world-cities)

```{r message=FALSE, warning=TRUE}
WorldCapital <- read.csv("./WorldCapitalCoordinates.csv")
```

but looking at this dataset I see some issues.
1) several cities are reported as capital. I will use only the primary one

```{r message=FALSE, warning=TRUE}
WorldCapital <- WorldCapital[WorldCapital$capital=="primary",]
```

2) some nation has more than one priamry capital. I will keep only the first one

```{r message=FALSE, warning=TRUE}
dup_filter <- duplicated(WorldCapital$iso3)
WorldCapital <- WorldCapital[!dup_filter,]
```

once done that, I merge the 2 dataset


```{r message=FALSE, warning=FALSE}
library(dplyr)
df_total <- df %>% merge(WorldCapital[,c(3,4,7)],by.x="ISO Code",by.y="iso3") 
```

and I plot the countries and their Legal System and Property Rights index.

```{r message=FALSE, warning=FALSE}
library(leaflet)
m <- leaflet(data = df_total) %>% addTiles() %>% addProviderTiles("Stamen.Watercolor") %>% addMarkers(lng=df_total$lng,lat=df_total$lat,clusterOptions=markerClusterOptions(),label = ~as.character(df_total$`Legal System and Property Rights`) )
m

```
